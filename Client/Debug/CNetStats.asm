; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.01 

	TITLE	d:\vice-players-master\Client\CNetStats.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMTD
INCLUDELIB OLDNAMES

PUBLIC	__real@00000000
PUBLIC	??0CNetStats@@QAE@XZ				; CNetStats::CNetStats
EXTRN	__imp__GetTickCount@0:PROC
EXTRN	__fltused:DWORD
EXTRN	__RTC_CheckEsp:PROC
EXTRN	__RTC_Shutdown:PROC
EXTRN	__RTC_InitBase:PROC
;	COMDAT __real@00000000
; File d:\vice-players-master\client\cnetstats.cpp
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
CONST	ENDS
;	COMDAT rtc$TMZ
rtc$TMZ	SEGMENT
__RTC_Shutdown.rtc$TMZ DD FLAT:__RTC_Shutdown
rtc$TMZ	ENDS
;	COMDAT rtc$IMZ
rtc$IMZ	SEGMENT
__RTC_InitBase.rtc$IMZ DD FLAT:__RTC_InitBase
; Function compile flags: /Odtp /RTCsu /ZI
rtc$IMZ	ENDS
;	COMDAT ??0CNetStats@@QAE@XZ
_TEXT	SEGMENT
_this$ = -8						; size = 4
??0CNetStats@@QAE@XZ PROC				; CNetStats::CNetStats, COMDAT
; _this$ = ecx

; 22   : {

	push	ebp
	mov	ebp, esp
	sub	esp, 204				; 000000ccH
	push	ebx
	push	esi
	push	edi
	push	ecx
	lea	edi, DWORD PTR [ebp-204]
	mov	ecx, 51					; 00000033H
	mov	eax, -858993460				; ccccccccH
	rep stosd
	pop	ecx
	mov	DWORD PTR _this$[ebp], ecx

; 23   : 	m_dwLastUpdateTick = GetTickCount();

	mov	esi, esp
	call	DWORD PTR __imp__GetTickCount@0
	cmp	esi, esp
	call	__RTC_CheckEsp
	mov	ecx, DWORD PTR _this$[ebp]
	mov	DWORD PTR [ecx+8], eax

; 24   : 	m_dwLastTotalBytesRecv = 0;

	mov	eax, DWORD PTR _this$[ebp]
	fldz
	fstp	DWORD PTR [eax+4]

; 25   : 	m_dwLastTotalBytesSent = 0;

	mov	eax, DWORD PTR _this$[ebp]
	fldz
	fstp	DWORD PTR [eax]

; 26   : 	m_dwBPSDownload = 0;

	mov	eax, DWORD PTR _this$[ebp]
	fldz
	fstp	DWORD PTR [eax+16]

; 27   : 	m_dwBPSUpload = 0;

	mov	eax, DWORD PTR _this$[ebp]
	fldz
	fstp	DWORD PTR [eax+12]

; 28   : }

	mov	eax, DWORD PTR _this$[ebp]
	pop	edi
	pop	esi
	pop	ebx
	add	esp, 204				; 000000ccH
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
??0CNetStats@@QAE@XZ ENDP				; CNetStats::CNetStats
_TEXT	ENDS
PUBLIC	__real@42480000
PUBLIC	??_C@_0MK@HMLCGMFH@?9?9?9?5Network?5Stats?5?9?9?9?6?6Bytes?5Per@ ; `string'
PUBLIC	?GetRakPeer@CNetworkManager@@QAEPAVRakPeerInterface@RakNet@@XZ ; CNetworkManager::GetRakPeer
PUBLIC	__$ArrayPad$
PUBLIC	?Draw@CNetStats@@QAEXXZ				; CNetStats::Draw
EXTRN	?DrawTextBox@CD3DFont@@QAEJMMMKKPBDK@Z:PROC	; CD3DFont::DrawTextBox
EXTRN	?pChatWindow@@3PAVCChatWindow@@A:DWORD		; pChatWindow
EXTRN	?pD3DDevice@@3PAUIDirect3DDevice8@@A:DWORD	; pD3DDevice
EXTRN	_sprintf:PROC
EXTRN	?GetTimeUS@RakNet@@YA_KXZ:PROC			; RakNet::GetTimeUS
EXTRN	?pNetowkManager@@3PAVCNetworkManager@@A:DWORD	; pNetowkManager
EXTRN	___security_cookie:DWORD
EXTRN	@__security_check_cookie@4:PROC
EXTRN	@_RTC_CheckStackVars@8:PROC
EXTRN	__aulldiv:PROC
;	COMDAT __real@42480000
CONST	SEGMENT
__real@42480000 DD 042480000r			; 50
CONST	ENDS
;	COMDAT ??_C@_0MK@HMLCGMFH@?9?9?9?5Network?5Stats?5?9?9?9?6?6Bytes?5Per@
CONST	SEGMENT
??_C@_0MK@HMLCGMFH@?9?9?9?5Network?5Stats?5?9?9?9?6?6Bytes?5Per@ DB '--- '
	DB	'Network Stats ---', 0aH, 0aH, 'Bytes Per Second Received: %d', 0aH
	DB	'Bytes Per Second Sent: %d', 0aH, 'Total Bytes Received: %d', 0aH
	DB	'Total Bytes Sent: %d', 0aH, 'Current Packet Loss: %.02f', 0aH
	DB	'Average Packet Loss: %.02f', 0aH, 'Connection Time: %ds', 0aH
	DB	0aH, 00H					; `string'
; Function compile flags: /Odtp /RTCsu /ZI
CONST	ENDS
;	COMDAT ?Draw@CNetStats@@QAEXXZ
_TEXT	SEGMENT
tv207 = -1368						; size = 8
tv67 = -1364						; size = 4
_fAveragePacketLoss$ = -1164				; size = 4
_fCurrentPacketLoss$ = -1152				; size = 4
_uConnectionTime$ = -1140				; size = 4
_uTotalBytesSent$ = -1128				; size = 4
_uTotalBytesReceived$ = -1116				; size = 4
_uBytesPerSecondSent$ = -1104				; size = 4
_uBytesPerSecondReceived$ = -1092			; size = 4
_pRakStats$ = -1080					; size = 4
_dDisplayMode$ = -1068					; size = 16
_szDispBuf$ = -1044					; size = 1024
_this$ = -12						; size = 4
__$ArrayPad$ = -4					; size = 4
?Draw@CNetStats@@QAEXXZ PROC				; CNetStats::Draw, COMDAT
; _this$ = ecx

; 31   : {

	push	ebp
	mov	ebp, esp
	sub	esp, 1368				; 00000558H
	push	ebx
	push	esi
	push	edi
	push	ecx
	lea	edi, DWORD PTR [ebp-1368]
	mov	ecx, 342				; 00000156H
	mov	eax, -858993460				; ccccccccH
	rep stosd
	pop	ecx
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, ebp
	mov	DWORD PTR __$ArrayPad$[ebp], eax
	mov	DWORD PTR _this$[ebp], ecx

; 32   : 	char szDispBuf[1024];
; 33   : 	D3DDISPLAYMODE dDisplayMode;
; 34   : 	RakNetStatistics *pRakStats = pNetowkManager->GetRakPeer()->GetStatistics(UNASSIGNED_SYSTEM_ADDRESS);

	mov	ecx, DWORD PTR ?pNetowkManager@@3PAVCNetworkManager@@A ; pNetowkManager
	call	?GetRakPeer@CNetworkManager@@QAEPAVRakPeerInterface@RakNet@@XZ ; CNetworkManager::GetRakPeer
	mov	DWORD PTR tv67[ebp], eax
	mov	esi, esp
	push	0
	mov	eax, DWORD PTR _UNASSIGNED_SYSTEM_ADDRESS+4
	push	eax
	mov	ecx, DWORD PTR _UNASSIGNED_SYSTEM_ADDRESS
	push	ecx
	mov	edx, DWORD PTR tv67[ebp]
	mov	eax, DWORD PTR [edx]
	mov	ecx, DWORD PTR tv67[ebp]
	mov	edx, DWORD PTR [eax+296]
	call	edx
	cmp	esi, esp
	call	__RTC_CheckEsp
	mov	DWORD PTR _pRakStats$[ebp], eax

; 35   : 
; 36   : 	unsigned int uBytesPerSecondReceived = (unsigned int)pRakStats->valueOverLastSecond[ACTUAL_BYTES_RECEIVED];

	mov	eax, DWORD PTR _pRakStats$[ebp]
	mov	ecx, DWORD PTR [eax+48]
	mov	DWORD PTR _uBytesPerSecondReceived$[ebp], ecx

; 37   : 	unsigned int uBytesPerSecondSent = (unsigned int)pRakStats->valueOverLastSecond[ACTUAL_BYTES_SENT];

	mov	eax, DWORD PTR _pRakStats$[ebp]
	mov	ecx, DWORD PTR [eax+40]
	mov	DWORD PTR _uBytesPerSecondSent$[ebp], ecx

; 38   : 	unsigned int uTotalBytesReceived= (unsigned int)pRakStats->runningTotal[ACTUAL_BYTES_RECEIVED];

	mov	eax, DWORD PTR _pRakStats$[ebp]
	mov	ecx, DWORD PTR [eax+104]
	mov	DWORD PTR _uTotalBytesReceived$[ebp], ecx

; 39   : 	unsigned int uTotalBytesSent = (unsigned int)pRakStats->runningTotal[ACTUAL_BYTES_SENT];

	mov	eax, DWORD PTR _pRakStats$[ebp]
	mov	ecx, DWORD PTR [eax+96]
	mov	DWORD PTR _uTotalBytesSent$[ebp], ecx

; 40   : 	unsigned int uConnectionTime = (unsigned int)((GetTimeUS() - pRakStats->connectionStartTime)/1000000);

	call	?GetTimeUS@RakNet@@YA_KXZ		; RakNet::GetTimeUS
	mov	ecx, DWORD PTR _pRakStats$[ebp]
	sub	eax, DWORD PTR [ecx+112]
	sbb	edx, DWORD PTR [ecx+116]
	push	0
	push	1000000					; 000f4240H
	push	edx
	push	eax
	call	__aulldiv
	mov	DWORD PTR _uConnectionTime$[ebp], eax

; 41   : 	float fCurrentPacketLoss = pRakStats->packetlossLastSecond;

	mov	eax, DWORD PTR _pRakStats$[ebp]
	fld	DWORD PTR [eax+216]
	fstp	DWORD PTR _fCurrentPacketLoss$[ebp]

; 42   : 	float fAveragePacketLoss = pRakStats->packetlossTotal;

	mov	eax, DWORD PTR _pRakStats$[ebp]
	fld	DWORD PTR [eax+220]
	fstp	DWORD PTR _fAveragePacketLoss$[ebp]

; 43   : 
; 44   : 	sprintf(szDispBuf,"--- Network Stats ---\n" \
; 45   : 					  "\n" \
; 46   : 					  "Bytes Per Second Received: %d\n" \
; 47   : 					  "Bytes Per Second Sent: %d\n" \
; 48   : 					  "Total Bytes Received: %d\n" \
; 49   : 					  "Total Bytes Sent: %d\n" \
; 50   : 					  "Current Packet Loss: %.02f\n" \
; 51   : 					  "Average Packet Loss: %.02f\n" \
; 52   : 					  "Connection Time: %ds\n" \
; 53   : 					  "\n", 
; 54   : 					  uBytesPerSecondReceived, uBytesPerSecondSent, 
; 55   : 					  uTotalBytesReceived, uTotalBytesSent, 
; 56   : 					  fCurrentPacketLoss, fAveragePacketLoss, 
; 57   : 					  uConnectionTime);

	mov	eax, DWORD PTR _uConnectionTime$[ebp]
	push	eax
	fld	DWORD PTR _fAveragePacketLoss$[ebp]
	sub	esp, 8
	fstp	QWORD PTR [esp]
	fld	DWORD PTR _fCurrentPacketLoss$[ebp]
	sub	esp, 8
	fstp	QWORD PTR [esp]
	mov	ecx, DWORD PTR _uTotalBytesSent$[ebp]
	push	ecx
	mov	edx, DWORD PTR _uTotalBytesReceived$[ebp]
	push	edx
	mov	eax, DWORD PTR _uBytesPerSecondSent$[ebp]
	push	eax
	mov	ecx, DWORD PTR _uBytesPerSecondReceived$[ebp]
	push	ecx
	push	OFFSET ??_C@_0MK@HMLCGMFH@?9?9?9?5Network?5Stats?5?9?9?9?6?6Bytes?5Per@
	lea	edx, DWORD PTR _szDispBuf$[ebp]
	push	edx
	call	_sprintf
	add	esp, 44					; 0000002cH

; 58   : 	
; 59   : //	StatisticsToString(pRakStats,szStatBuf,1);
; 60   : 
; 61   : 	pD3DDevice->GetDisplayMode(&dDisplayMode);

	mov	esi, esp
	lea	eax, DWORD PTR _dDisplayMode$[ebp]
	push	eax
	mov	ecx, DWORD PTR ?pD3DDevice@@3PAUIDirect3DDevice8@@A ; pD3DDevice
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR ?pD3DDevice@@3PAUIDirect3DDevice8@@A ; pD3DDevice
	push	eax
	mov	ecx, DWORD PTR [edx+32]
	call	ecx
	cmp	esi, esp
	call	__RTC_CheckEsp

; 62   : 	pChatWindow->m_pD3DFont->DrawTextBox((float)((dDisplayMode.Width / 2) - 100),50.0f,50.0f,0x50000000,0xFFFFFFFF,szDispBuf,0L);

	push	0
	lea	eax, DWORD PTR _szDispBuf$[ebp]
	push	eax
	push	-1
	push	1342177280				; 50000000H
	push	ecx
	fld	DWORD PTR __real@42480000
	fstp	DWORD PTR [esp]
	push	ecx
	fld	DWORD PTR __real@42480000
	fstp	DWORD PTR [esp]
	mov	ecx, DWORD PTR _dDisplayMode$[ebp]
	shr	ecx, 1
	sub	ecx, 100				; 00000064H
	mov	DWORD PTR tv207[ebp], ecx
	mov	DWORD PTR tv207[ebp+4], 0
	fild	QWORD PTR tv207[ebp]
	push	ecx
	fstp	DWORD PTR [esp]
	mov	edx, DWORD PTR ?pChatWindow@@3PAVCChatWindow@@A ; pChatWindow
	mov	ecx, DWORD PTR [edx+968]
	call	?DrawTextBox@CD3DFont@@QAEJMMMKKPBDK@Z	; CD3DFont::DrawTextBox

; 63   : }

	push	edx
	mov	ecx, ebp
	push	eax
	lea	edx, DWORD PTR $LN6@Draw
	call	@_RTC_CheckStackVars@8
	pop	eax
	pop	edx
	pop	edi
	pop	esi
	pop	ebx
	mov	ecx, DWORD PTR __$ArrayPad$[ebp]
	xor	ecx, ebp
	call	@__security_check_cookie@4
	add	esp, 1368				; 00000558H
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
	npad	2
$LN6@Draw:
	DD	2
	DD	$LN5@Draw
$LN5@Draw:
	DD	-1044					; fffffbecH
	DD	1024					; 00000400H
	DD	$LN3@Draw
	DD	-1068					; fffffbd4H
	DD	16					; 00000010H
	DD	$LN4@Draw
$LN4@Draw:
	DB	100					; 00000064H
	DB	68					; 00000044H
	DB	105					; 00000069H
	DB	115					; 00000073H
	DB	112					; 00000070H
	DB	108					; 0000006cH
	DB	97					; 00000061H
	DB	121					; 00000079H
	DB	77					; 0000004dH
	DB	111					; 0000006fH
	DB	100					; 00000064H
	DB	101					; 00000065H
	DB	0
$LN3@Draw:
	DB	115					; 00000073H
	DB	122					; 0000007aH
	DB	68					; 00000044H
	DB	105					; 00000069H
	DB	115					; 00000073H
	DB	112					; 00000070H
	DB	66					; 00000042H
	DB	117					; 00000075H
	DB	102					; 00000066H
	DB	0
?Draw@CNetStats@@QAEXXZ ENDP				; CNetStats::Draw
; Function compile flags: /Odtp /RTCsu /ZI
; File d:\vice-players-master\client\net\cnetworkmanager.h
_TEXT	ENDS
;	COMDAT ?GetRakPeer@CNetworkManager@@QAEPAVRakPeerInterface@RakNet@@XZ
_TEXT	SEGMENT
_this$ = -8						; size = 4
?GetRakPeer@CNetworkManager@@QAEPAVRakPeerInterface@RakNet@@XZ PROC ; CNetworkManager::GetRakPeer, COMDAT
; _this$ = ecx

; 85   : 	RakPeerInterface * GetRakPeer() { return m_pRakPeer; };

	push	ebp
	mov	ebp, esp
	sub	esp, 204				; 000000ccH
	push	ebx
	push	esi
	push	edi
	push	ecx
	lea	edi, DWORD PTR [ebp-204]
	mov	ecx, 51					; 00000033H
	mov	eax, -858993460				; ccccccccH
	rep stosd
	pop	ecx
	mov	DWORD PTR _this$[ebp], ecx
	mov	eax, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR [eax+24]
	pop	edi
	pop	esi
	pop	ebx
	mov	esp, ebp
	pop	ebp
	ret	0
?GetRakPeer@CNetworkManager@@QAEPAVRakPeerInterface@RakNet@@XZ ENDP ; CNetworkManager::GetRakPeer
_TEXT	ENDS
EXTRN	??0SystemAddress@RakNet@@QAE@IG@Z:PROC		; RakNet::SystemAddress::SystemAddress
; Function compile flags: /Odtp /RTCsu /ZI
; File d:\vice-players-master\raknet\raknettypes.h
;	COMDAT ??__EUNASSIGNED_SYSTEM_ADDRESS@RakNet@@YAXXZ
text$yc	SEGMENT
??__EUNASSIGNED_SYSTEM_ADDRESS@RakNet@@YAXXZ PROC	; RakNet::`dynamic initializer for 'UNASSIGNED_SYSTEM_ADDRESS'', COMDAT

; 196  : const SystemAddress UNASSIGNED_SYSTEM_ADDRESS(0xFFFFFFFF, 0xFFFF);

	push	ebp
	mov	ebp, esp
	sub	esp, 192				; 000000c0H
	push	ebx
	push	esi
	push	edi
	lea	edi, DWORD PTR [ebp-192]
	mov	ecx, 48					; 00000030H
	mov	eax, -858993460				; ccccccccH
	rep stosd
	push	65535					; 0000ffffH
	push	-1
	mov	ecx, OFFSET _UNASSIGNED_SYSTEM_ADDRESS
	call	??0SystemAddress@RakNet@@QAE@IG@Z	; RakNet::SystemAddress::SystemAddress
	pop	edi
	pop	esi
	pop	ebx
	add	esp, 192				; 000000c0H
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
??__EUNASSIGNED_SYSTEM_ADDRESS@RakNet@@YAXXZ ENDP	; RakNet::`dynamic initializer for 'UNASSIGNED_SYSTEM_ADDRESS''
text$yc	ENDS
_BSS	SEGMENT
_UNASSIGNED_SYSTEM_ADDRESS DQ 01H DUP (?)
_BSS	ENDS
CRT$XCU	SEGMENT
_UNASSIGNED_SYSTEM_ADDRESS$initializer$ DD FLAT:??__EUNASSIGNED_SYSTEM_ADDRESS@RakNet@@YAXXZ
CRT$XCU	ENDS
END
